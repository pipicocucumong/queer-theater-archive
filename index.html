<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÌïúÍµ≠ ÌÄ¥Ïñ¥ Ïó∞Í∑π ÏïÑÏπ¥Ïù¥Î∏å</title>
    
    <!-- ÌååÎπÑÏΩò -->
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    
    <!-- OG Î©îÌÉÄÌÉúÍ∑∏ (ÎßÅÌÅ¨ Í≥µÏú† ÎØ∏Î¶¨Î≥¥Í∏∞) -->
    <meta property="og:title" content="ÌïúÍµ≠ ÌÄ¥Ïñ¥ Ïó∞Í∑π ÏïÑÏπ¥Ïù¥Î∏å">
    <meta property="og:description" content="2010ÎÖÑÎ∂ÄÌÑ∞ ÌòÑÏû¨ÍπåÏßÄ ÌïúÍµ≠ÏóêÏÑú Í≥µÏó∞Îêú ÌÄ¥Ïñ¥ Ïó∞Í∑πÏùÑ Í∏∞Î°ùÌïòÍ≥† Î≥¥Ï°¥ÌïòÎäî ÌîÑÎ°úÏ†ùÌä∏">
    <meta property="og:image" content="https://pipicocucumong.github.io/queer-theater-archive/og-image.png">
    <meta property="og:url" content="https://pipicocucumong.github.io/queer-theater-archive/">
    <meta property="og:type" content="website">
    
    <!-- Ìä∏ÏúÑÌÑ∞ Ïπ¥Îìú -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ÌïúÍµ≠ ÌÄ¥Ïñ¥ Ïó∞Í∑π ÏïÑÏπ¥Ïù¥Î∏å">
    <meta name="twitter:description" content="2010ÎÖÑÎ∂ÄÌÑ∞ ÌòÑÏû¨ÍπåÏßÄ ÌïúÍµ≠ÏóêÏÑú Í≥µÏó∞Îêú ÌÄ¥Ïñ¥ Ïó∞Í∑πÏùÑ Í∏∞Î°ùÌïòÍ≥† Î≥¥Ï°¥ÌïòÎäî ÌîÑÎ°úÏ†ùÌä∏">
    <meta name="twitter:image" content="https://pipicocucumong.github.io/queer-theater-archive/og-image.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;800;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        /* Ï†ëÍ∑ºÏÑ±: Ìè¨Ïª§Ïä§ Ïä§ÌÉÄÏùº */
        a:focus, button:focus, input:focus, select:focus, [tabindex]:focus {
            outline: 2px solid #fff;
            outline-offset: 2px;
        }
        
        /* Ï†ëÍ∑ºÏÑ±: ÏµúÏÜå ÌÑ∞Ïπò ÏòÅÏó≠ */
        button, a {
            min-height: 44px;
        }
        
        /* Ï†ëÍ∑ºÏÑ±: ÌÖçÏä§Ìä∏ ÌÅ¨Í∏∞ Ï°∞Ï†ï ÌóàÏö© */
        html {
            -webkit-text-size-adjust: 100%;
        }
        
        :root {
            --orange: #FF6B00;
            --purple: #7B2D8E;
        }
        
        body {
            font-family: "Noto Sans KR", "ÎßëÏùÄ Í≥†Îîï", sans-serif;
            background: #fff;
            color: #000;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .page { display: none; overflow-x: hidden; }
        .page.active { display: block; }

        /* =====================================================
           Ìôà - 6Ïª¨Îüº Î¨¥ÏßÄÍ∞ú Î†àÏù¥ÏïÑÏõÉ
           ===================================================== */
        .home-rainbow {
            min-height: 100vh;
            display: grid;
            grid-template-columns: repeat(6, 1fr);
        }

        .home-col {
            padding: 40px 25px;
            display: flex;
            flex-direction: column;
            color: #fff;
            min-height: 100vh;
        }

        .home-col:nth-child(1) { background: #E40303; }
        .home-col:nth-child(2) { background: #FF8C00; }
        .home-col:nth-child(3) { background: #FFED00; color: #000; }
        .home-col:nth-child(4) { background: #008026; }
        .home-col:nth-child(5) { background: #24408E; }
        .home-col:nth-child(6) { background: #732982; }

        .home-col-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            opacity: 0.7;
            margin-bottom: 20px;
        }

        .home-logo {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            border-radius: 8px;
        }

        .home-col-title {
            font-size: clamp(28px, 4vw, 48px);
            font-weight: 600;
            line-height: 1.3;
            letter-spacing: 0.02em;
            margin-bottom: auto;
        }

        .home-col-content {
            margin-top: auto;
        }

        .home-col-big {
            font-size: clamp(48px, 8vw, 100px);
            font-weight: 600;
            line-height: 0.9;
        }

        .home-col-small {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .home-col a {
            color: inherit;
            text-decoration: none;
            display: block;
            font-size: clamp(18px, 2.5vw, 28px);
            font-weight: 600;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255,255,255,0.3);
            transition: all 0.15s;
        }

        .home-col:nth-child(3) a {
            border-bottom-color: rgba(0,0,0,0.2);
        }

        .home-col a:first-of-type {
            border-top: 1px solid rgba(255,255,255,0.3);
        }

        .home-col:nth-child(3) a:first-of-type {
            border-top-color: rgba(0,0,0,0.2);
        }

        .home-col a:hover {
            padding-left: 15px;
            opacity: 0.8;
        }

        .home-search-input {
            width: 100%;
            padding: 12px 0;
            border: none;
            border-bottom: 2px solid currentColor;
            background: transparent;
            font-family: inherit;
            font-size: 14px;
            color: inherit;
            opacity: 0.9;
        }

        .home-search-input::placeholder {
            color: inherit;
            opacity: 0.5;
        }

        .home-search-input:focus {
            outline: none;
            opacity: 1;
        }

        .home-tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 15px;
        }

        .home-tag-item {
            font-size: 13px;
            padding: 6px 12px;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 0;
            font-weight: 500;
            color: #fff;
            animation: tagSparkle 3s ease-in-out infinite;
        }

        /* special.fish Ïä§ÌÉÄÏùº ÏÉâÏÉÅ */
        .home-tag-item:nth-child(1) { background: #e74c3c; animation-delay: 0s; }
        .home-tag-item:nth-child(2) { background: #9b59b6; animation-delay: 0.15s; }
        .home-tag-item:nth-child(3) { background: #3498db; animation-delay: 0.3s; }
        .home-tag-item:nth-child(4) { background: #1abc9c; animation-delay: 0.45s; }
        .home-tag-item:nth-child(5) { background: #2ecc71; animation-delay: 0.6s; }
        .home-tag-item:nth-child(6) { background: #f39c12; animation-delay: 0.75s; }
        .home-tag-item:nth-child(7) { background: #e67e22; animation-delay: 0.9s; }
        .home-tag-item:nth-child(8) { background: #34495e; animation-delay: 1.05s; }
        .home-tag-item:nth-child(9) { background: #16a085; animation-delay: 1.2s; }
        .home-tag-item:nth-child(10) { background: #8e44ad; animation-delay: 1.35s; }
        .home-tag-item:nth-child(11) { background: #2980b9; animation-delay: 1.5s; }
        .home-tag-item:nth-child(12) { background: #27ae60; animation-delay: 1.65s; }
        .home-tag-item:nth-child(13) { background: #d35400; animation-delay: 1.8s; }
        .home-tag-item:nth-child(14) { background: #c0392b; animation-delay: 1.95s; }
        .home-tag-item:nth-child(15) { background: #7f8c8d; animation-delay: 2.1s; }
        .home-tag-item:nth-child(16) { background: #f1c40f; color: #333; animation-delay: 2.25s; }
        .home-tag-item:nth-child(17) { background: #95a5a6; animation-delay: 2.4s; }
        .home-tag-item:nth-child(18) { background: #e91e63; animation-delay: 2.55s; }
        .home-tag-item:nth-child(19) { background: #00bcd4; animation-delay: 2.7s; }
        .home-tag-item:nth-child(20) { background: #673ab7; animation-delay: 2.85s; }

        @keyframes tagSparkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.65; }
        }

        .home-tag-item:hover {
            opacity: 1 !important;
            filter: brightness(1.15);
        }

        /* =====================================================
           ÏïÑÏπ¥Ïù¥Î∏å - Ï£ºÌô©/Î≥¥Îùº Î∞òÎ∞ò
           ===================================================== */
        .archive-split {
            min-height: 100vh;
            display: grid;
            grid-template-columns: 350px 1fr;
        }

        .archive-sidebar {
            background: var(--orange);
            color: #fff;
            padding: 40px;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .archive-back {
            font-size: 12px;
            color: #fff;
            text-decoration: none;
            margin-bottom: 36px;
            display: inline-block;
            text-transform: uppercase;
            letter-spacing: 0.12em;
        }

        .archive-back:hover {
            text-decoration: underline;
        }

        .archive-sidebar-title {
            font-size: clamp(28px, 4.5vw, 52px);
            font-weight: 600;
            line-height: 1.15;
            margin-bottom: 12px;
            letter-spacing: 0.04em;
        }

        .archive-sidebar-count {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 32px;
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }

        .archive-filters {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .archive-select {
            padding: 12px 14px;
            border: 2px solid #fff;
            background: transparent;
            color: #fff;
            font-family: "Arial Black","Arial","ÎßëÏùÄ Í≥†Îîï",system-ui,sans-serif;
            font-size: 12px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .archive-select option {
            background: var(--orange);
            color: #fff;
            font-family: "Arial","ÎßëÏùÄ Í≥†Îîï",system-ui,sans-serif;
        }

        .archive-input {
            padding: 12px 14px;
            border: 2px solid #fff;
            background: transparent;
            color: #fff;
            font-family: "Arial Black","Arial","ÎßëÏùÄ Í≥†Îîï",system-ui,sans-serif;
            font-size: 12px;
            letter-spacing: 0.04em;
        }

        .archive-input::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .archive-input:focus {
            outline: none;
            background: #fff;
            color: var(--orange);
        }

        .archive-clear {
            padding: 12px 14px;
            border: 2px solid #fff;
            background: #fff;
            color: var(--orange);
            font-family: "Arial Black","Arial","ÎßëÏùÄ Í≥†Îîï",system-ui,sans-serif;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .archive-clear:hover {
            background: transparent;
            color: #fff;
        }

        .archive-selected-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 20px;
        }

        .archive-selected-tag {
            padding: 8px 14px;
            background: #fff;
            color: var(--orange);
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        /* Ïû•Î∞îÍµ¨Îãà Ïä§ÌÉÄÏùº */
        .cart-section {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .cart-title {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
        }

        .cart-clear-btn {
            background: transparent;
            border: none;
            color: rgba(255,255,255,0.6);
            font-size: 12px;
            cursor: pointer;
        }

        .cart-clear-btn:hover {
            color: #fff;
        }

        .cart-list {
            max-height: 150px;
            overflow-y: auto;
            margin-bottom: 10px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 13px;
            color: #fff;
        }

        .cart-item-title {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-right: 10px;
        }

        .cart-item-remove {
            background: transparent;
            border: none;
            color: rgba(255,255,255,0.5);
            cursor: pointer;
            font-size: 16px;
            padding: 0 5px;
        }

        .cart-item-remove:hover {
            color: #ff6b6b;
        }

        .cart-print-btn {
            width: 100%;
            padding: 10px;
            background: #fff;
            color: var(--orange);
            border: none;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
        }

        .cart-print-btn:hover {
            background: rgba(255,255,255,0.9);
        }

        /* ÏïÑÏπ¥Ïù¥Î∏å ÏïÑÏù¥ÌÖúÏóê Ï≤¥ÌÅ¨Î∞ïÏä§ Ï∂îÍ∞Ä */
        .archive-item-checkbox {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            min-width: 18px;
            min-height: 18px;
            border: 2px solid rgba(255,255,255,0.5);
            border-radius: 3px;
            background: transparent;
            cursor: pointer;
            flex-shrink: 0;
            position: relative;
        }

        .archive-item-checkbox:checked {
            background: var(--orange);
            border-color: var(--orange);
        }

        .archive-item-checkbox:checked::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 12px;
            font-weight: bold;
        }

        .archive-pagination {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 20px;
        }

        .archive-pagination button {
            padding: 8px 14px;
            background: transparent;
            color: #fff;
            border: 1px solid #fff;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
        }

        .archive-pagination button:hover {
            background: rgba(255,255,255,0.2);
        }

        .archive-pagination button.active {
            background: #fff;
            color: var(--orange);
            font-weight: 700;
        }

        .archive-main {
            background: var(--purple);
            color: #fff;
            padding: 40px;
            overflow-y: auto;
        }

        .archive-list {
            display: flex;
            flex-direction: column;
        }

        .archive-item {
            display: grid;
            grid-template-columns: 24px 50px 1fr auto;
            gap: 15px;
            padding: 26px 0;
            border-bottom: 1px solid rgba(255,255,255,0.25);
            cursor: pointer;
            transition: all 0.15s;
            align-items: center;
        }

        .archive-item:hover {
            background: rgba(255,255,255,0.12);
            padding-left: 20px;
            padding-right: 20px;
            margin-left: -20px;
            margin-right: -20px;
        }

        .archive-item-index {
            font-size: 12px;
            opacity: 0.6;
            letter-spacing: 0.16em;
            text-transform: uppercase;
        }

        .archive-item-title {
            font-size: clamp(18px, 2.5vw, 28px);
            font-weight: 600;
            line-height: 1.2;
            letter-spacing: 0.02em;
        }

        .archive-item-meta {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 4px;
        }

        .archive-item-info {
            cursor: pointer;
        }

        .archive-item-year {
            font-size: clamp(24px, 3.5vw, 40px);
            font-weight: 600;
            opacity: 0.4;
        }

        /* =====================================================
           ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄ - ÏñëÎ∂ÑÌï† Î†àÏù¥ÏïÑÏõÉ
           ===================================================== */
        .detail-page {
            display: flex;
            min-height: 100vh;
        }

        .detail-left {
            width: 42%;
            background: var(--orange);
            color: #fff;
            position: relative;
        }

        .detail-left-inner {
            position: sticky;
            top: 0;
            padding: 50px 45px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .detail-back {
            color: #fff;
            text-decoration: none;
            font-size: 12px;
            margin-bottom: 40px;
            display: inline-block;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        .detail-back:hover {
            text-decoration: underline;
        }

        .detail-poster {
            width: 100%;
            max-width: 260px;
            margin: 0 auto 35px;
        }

        .detail-poster img {
            width: 100%;
            height: auto;
            display: block;
            box-shadow: 0 8px 30px rgba(0,0,0,0.3);
        }

        .detail-poster-empty {
            width: 200px;
            height: 280px;
            margin: 0 auto 35px;
            border: 3px solid rgba(255,255,255,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            opacity: 0.6;
            letter-spacing: 0.1em;
        }

        .detail-title {
            font-size: clamp(28px, 4vw, 44px);
            font-weight: 700;
            margin-bottom: 35px;
            letter-spacing: -0.01em;
            line-height: 1.25;
            animation: titleSparkle 2.5s ease-in-out infinite;
        }

        @keyframes titleSparkle {
            0%, 100% { opacity: 1; text-shadow: 0 0 0 transparent; }
            50% { opacity: 0.7; text-shadow: 0 0 20px rgba(255,255,255,0.5); }
        }

        .detail-meta-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 22px 30px;
            margin-bottom: 30px;
        }

        .detail-meta-item {
            border-left: 3px solid rgba(255,255,255,0.5);
            padding-left: 14px;
        }

        .detail-meta-label {
            font-size: 12px;
            opacity: 0.6;
            margin-bottom: 6px;
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }

        .detail-meta-value {
            font-size: 17px;
            line-height: 1.5;
            word-break: keep-all;
            font-weight: 500;
        }

        .detail-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: auto;
            padding-top: 30px;
        }

        .detail-tag {
            padding: 8px 16px;
            border: 1px solid #fff;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            background: transparent;
            color: #fff;
            animation: sparkle 2s ease-in-out infinite;
        }

        .detail-tag:hover {
            background: #fff;
            color: var(--orange);
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.15; }
        }

        .detail-tag:nth-child(1) { animation-delay: 0s; }
        .detail-tag:nth-child(2) { animation-delay: 0.25s; }
        .detail-tag:nth-child(3) { animation-delay: 0.5s; }
        .detail-tag:nth-child(4) { animation-delay: 0.75s; }
        .detail-tag:nth-child(5) { animation-delay: 1s; }
        .detail-tag:nth-child(6) { animation-delay: 1.25s; }
        .detail-tag:nth-child(7) { animation-delay: 1.5s; }
        .detail-tag:nth-child(8) { animation-delay: 1.75s; }
        .detail-tag:nth-child(9) { animation-delay: 2s; }
        .detail-tag:nth-child(10) { animation-delay: 2.25s; }


        /* Í≥µÏú† Î≤ÑÌäº Ïä§ÌÉÄÏùº */
.share-section {
    margin-top: 25px;
    padding-top: 20px;
    border-top: 1px solid rgba(255,255,255,0.3);
}

.share-label {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    opacity: 0.6;
    margin-bottom: 12px;
}

.share-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.share-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 10px 16px;
    border: 1px solid rgba(255,255,255,0.5);
    background: transparent;
    color: #fff;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    border-radius: 4px;
    font-family: inherit;
}

.share-btn:hover {
    background: #fff;
    color: var(--orange);
    border-color: #fff;
}

.share-btn svg {
    width: 16px;
    height: 16px;
}

.share-toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: #333;
    color: #fff;
    padding: 12px 24px;
    border-radius: 8px;
    font-size: 14px;
    z-index: 9999;
    animation: toastIn 0.3s ease;
}

@keyframes toastIn {
    from { opacity: 0; transform: translateX(-50%) translateY(20px); }
    to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

        .detail-right {
            width: 58%;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .detail-right-top {
            flex: 1;
            background: #fff;
            color: #333;
            padding: 50px 55px;
            display: flex;
            flex-direction: column;
        }

        .detail-right-bottom {
            flex: 1;
            background: var(--purple);
            color: #fff;
            padding: 50px 55px;
            display: flex;
            flex-direction: column;
        }

        .detail-section {
            margin-bottom: 0;
        }

        .detail-section-title {
            font-size: clamp(48px, 8vw, 80px);
            font-weight: 900;
            margin-bottom: 35px;
            letter-spacing: -0.03em;
            line-height: 1;
            animation: sparkle 4s ease-in-out infinite;
        }

        .detail-right-top .detail-section-title {
            color: #000;
            opacity: 0.15;
        }

        .detail-right-bottom .detail-section-title {
            color: #fff;
            opacity: 0.2;
        }

        .detail-section-subtitle {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 18px;
            letter-spacing: 0.02em;
            opacity: 0.5;
        }

        .detail-right-top .detail-section-subtitle {
            color: #000;
        }

        .detail-right-bottom .detail-section-subtitle {
            color: #fff;
        }

        .detail-archiver-section {
            margin-top: 40px;
            padding-top: 35px;
            border-top: 1px solid #ddd;
        }

        .detail-archiver-section .detail-section-subtitle {
            font-size: 14px;
            font-weight: 600;
            color: #000;
            margin-bottom: 20px;
            opacity: 0.4;
        }

        .detail-archiver-section .detail-text {
            font-size: 19px;
            color: #333;
        }

        .detail-text {
            font-family: "Noto Sans KR", "ÎßëÏùÄ Í≥†Îîï", sans-serif;
            font-size: 21px;
            font-weight: 400;
            line-height: 1.85;
            letter-spacing: 0.01em;
            word-break: keep-all;
            text-align: left;
        }

        .detail-right-top .detail-text {
            color: #333;
        }

        .detail-right-bottom .detail-text {
            color: #fff;
            opacity: 0.95;
        }

        .detail-text p {
            margin-bottom: 1.5em;
        }

        .detail-text p:last-child {
            margin-bottom: 0;
        }

        .detail-text strong {
            font-weight: 700;
            display: block;
            margin-top: 0.3em;
            margin-bottom: 0.3em;
        }

        .detail-right-top .detail-text strong {
            color: #000;
        }

        .detail-right-bottom .detail-text strong {
            color: #fff;
        }

        .detail-text p:first-child strong:first-child {
            margin-top: 0;
        }

        .detail-right-top .detail-text a {
            color: var(--purple);
            text-decoration: underline;
        }

        .detail-right-bottom .detail-text a {
            color: #fff;
            text-decoration: underline;
        }

        .detail-source {
            margin-top: 20px;
        }

        .detail-right-top .detail-source a {
            color: var(--purple);
            text-decoration: underline;
            font-size: 14px;
        }

        .detail-right-bottom .detail-source a {
            color: #fff;
            text-decoration: underline;
            font-size: 14px;
        }

        .detail-links {
            list-style: none;
        }

        .detail-links li {
            margin-bottom: 14px;
        }

        .detail-links a {
            color: #fff;
            text-decoration: none;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: opacity 0.2s;
        }

        .detail-links a:hover {
            opacity: 0.7;
        }

        .detail-links a::before {
            content: '‚Üí';
        }

        .detail-empty {
            opacity: 0.5;
            font-size: 14px;
        }

        /* =====================================================
           ÏÜåÍ∞ú ÌéòÏù¥ÏßÄ
           ===================================================== */
        .about-page-container {
            min-height: 100vh;
            background: linear-gradient(135deg, 
                #E40303 0%, #E40303 16.66%,
                #FF8C00 16.66%, #FF8C00 33.33%,
                #FFED00 33.33%, #FFED00 50%,
                #008026 50%, #008026 66.66%,
                #24408E 66.66%, #24408E 83.33%,
                #732982 83.33%, #732982 100%
            );
        }

        .about-header {
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            padding: 34px 60px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .about-content-wrapper {
            max-width: 800px;
            margin: 0 auto;
            padding: 60px 40px;
        }

        .about-logo-area {
            text-align: center;
            margin-bottom: 40px;
        }

        .about-logo {
            width: 150px;
            height: 150px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .about-text-area {
            background: rgba(255, 255, 255, 0.95);
            padding: 50px;
            border-radius: 12px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.15);
            color: #333;
            line-height: 1.8;
            font-size: 16px;
        }

        .about-text-area h1, .about-text-area h2, .about-text-area h3 {
            color: #7B2D8E;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        .about-text-area h1:first-child, .about-text-area h2:first-child, .about-text-area h3:first-child {
            margin-top: 0;
        }

        .about-text-area p {
            margin-bottom: 15px;
            text-align: justify;
        }

        .about-text-area a {
            color: #24408E;
        }

        /* Ïó∞ÌòÅ ÌÉÄÏûÑÎùºÏù∏ Ïä§ÌÉÄÏùº */
        .timeline {
            position: relative;
            padding-left: 30px;
            margin: 20px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 6px;
            top: 8px;
            bottom: 8px;
            width: 2px;
            background: #24408E;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 25px;
        }

        .timeline-item:last-child {
            margin-bottom: 0;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 8px;
            width: 10px;
            height: 10px;
            background: #24408E;
            border-radius: 50%;
        }

        .timeline-date {
            font-weight: 700;
            color: #24408E;
            margin-bottom: 5px;
        }

        .timeline-content {
            color: #333;
            line-height: 1.6;
        }

        /* =====================================================
           Í≥µÏßÄ/ÏûêÎ£å ÌéòÏù¥ÏßÄ - Í≤åÏãúÌåê Ïä§ÌÉÄÏùº
           ===================================================== */
        .featured-page {
            min-height: 100vh;
        }

        .featured-header {
            background: var(--orange);
            color: #fff;
            padding: 34px 60px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .featured-title {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.12em;
        }

        .featured-grid {
            display: flex;
            flex-direction: column;
            background: #f5f5f5;
        }

        .notice-board {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            background: #fff;
            color: #333;
        }

        .notice-header {
            display: grid;
            grid-template-columns: 60px 1fr 100px;
            padding: 15px 20px;
            background: #f5f5f5;
            border-bottom: 2px solid #333;
            font-weight: 600;
            font-size: 14px;
        }

        .notice-header span:last-child {
            text-align: right;
        }

        .notice-list {
            width: 100%;
        }

        .notice-item {
            display: grid;
            grid-template-columns: 60px 1fr 100px;
            padding: 15px 20px;
            border-bottom: 1px solid #e0e0e0;
            cursor: pointer;
            transition: background 0.2s;
            color: #333;
            background: #fff;
        }

        .notice-item:hover {
            background: #f9f9f9;
        }

        .notice-item-num {
            font-size: 14px;
            color: #666;
            text-align: center;
        }

        .notice-item-title {
            font-size: 15px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding-right: 20px;
        }

        .notice-item-date {
            font-size: 13px;
            color: #888;
            text-align: right;
        }

        .notice-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
            padding: 20px;
            background: #fff;
            border-top: 1px solid #e0e0e0;
        }

        .notice-pagination button {
            min-width: 32px;
            height: 32px;
            padding: 0 10px;
            border: 1px solid #ddd;
            background: #fff;
            color: #333;
            cursor: pointer;
            font-size: 14px;
            border-radius: 4px;
        }

        .notice-pagination button:hover {
            background: #f0f0f0;
        }

        .notice-pagination button.active {
            background: var(--purple);
            color: #fff;
            border-color: var(--purple);
        }

        .notice-empty {
            padding: 60px 20px;
            text-align: center;
            color: #888;
            background: #fff;
        }

        /* =====================================================
           Í∏Ä ÏÉÅÏÑ∏
           ===================================================== */
        .article-page {
            min-height: 100vh;
        }

        .article-header {
            background: var(--purple);
            color: #fff;
            padding: 34px 60px;
        }

        .article-hero {
            background: var(--orange);
            color: #fff;
            padding: 90px 60px;
        }

        .article-hero-inner {
            max-width: 800px;
            margin: 0 auto;
        }

        .article-title {
            font-size: clamp(32px, 6.5vw, 68px);
            font-weight: 600;
            line-height: 1.1;
            margin-bottom: 18px;
        }

        .article-meta {
            font-size: 13px;
            opacity: 0.8;
            letter-spacing: 0.12em;
            text-transform: uppercase;
        }

        .article-body {
            background: #fff;
            color: #000;
            padding: 70px 60px;
        }

        .article-body-inner {
            max-width: 700px;
            margin: 0 auto;
            font-size: 17px;
            line-height: 2;
        }

        .article-body-inner p {
            margin-bottom: 1.5em;
        }

        .article-body-inner h3 {
            font-size: 22px;
            font-weight: 600;
            margin: 2em 0 1em;
            color: var(--purple);
        }

        /* =====================================================
           Î™®Î∞îÏùº ÎåÄÏùë
           ===================================================== */
        @media (max-width: 900px) {
            .home-rainbow {
                grid-template-columns: repeat(2, 1fr);
                grid-template-rows: repeat(3, auto);
            }

            .home-col {
                min-height: 50vh;
                padding: 30px 20px;
            }

            .home-col-title {
                font-size: clamp(24px, 8vw, 40px);
            }

            .home-col-big {
                font-size: clamp(36px, 12vw, 60px);
            }

            .home-col a {
                font-size: clamp(16px, 5vw, 24px);
                padding: 12px 0;
            }

            .archive-split {
                grid-template-columns: 1fr;
            }

            .archive-sidebar {
                position: relative;
                height: auto;
                padding: 30px;
            }

            .archive-main {
                padding: 30px;
            }

            .archive-item {
                grid-template-columns: 20px 35px 1fr;
                gap: 10px;
            }

            .archive-item-year {
                display: none;
            }

            .detail-page {
                flex-direction: column;
            }

            .detail-left {
                width: 100%;
                position: relative;
            }

            .detail-left-inner {
                position: relative;
                min-height: auto;
                padding: 35px 25px;
            }

            .detail-poster {
                max-width: 180px;
                margin-bottom: 25px;
            }

            .detail-poster-empty {
                width: 150px;
                height: 210px;
                margin-bottom: 25px;
            }

            .detail-title {
                font-size: 24px;
                margin-bottom: 25px;
            }

            .detail-meta-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .detail-meta-value {
                font-size: 15px;
            }

            .detail-archiver-section {
                margin-top: 30px;
                padding-top: 25px;
            }
            
            .detail-text {
                font-size: 18px;
            }

            .detail-right {
                width: 100%;
            }

            .detail-right-top,
            .detail-right-bottom {
                padding: 35px 25px;
            }

            .notice-header {
                grid-template-columns: 50px 1fr 80px;
                padding: 12px 15px;
                font-size: 13px;
            }

            .notice-item {
                grid-template-columns: 50px 1fr 80px;
                padding: 12px 15px;
            }

            .notice-item-title {
                font-size: 14px;
            }

            .notice-item-date {
                font-size: 12px;
            }

            .article-hero {
                padding: 70px 30px;
            }

            .article-body {
                padding: 50px 30px;
            }

            .about-content-wrapper {
                padding: 30px 20px;
            }
            .about-text-area {
                padding: 30px 25px;
            }
            .about-logo {
                width: 100px;
                height: 100px;
            }
            .about-header {
                padding: 20px 25px;
            }
        }

        @media (max-width: 480px) {
            .home-rainbow {
                grid-template-columns: repeat(2, 1fr);
                grid-template-rows: repeat(3, auto);
            }

            .home-col {
                min-height: auto;
                padding: 30px 20px;
            }

            .home-col-title {
                font-size: 24px;
            }

            .home-col-big {
                font-size: 36px;
            }

            .detail-left-inner {
                padding: 30px 20px;
            }

            .detail-right-top,
            .detail-right-bottom {
                padding: 30px 20px;
            }

            .detail-title {
                font-size: 22px;
            }

            .detail-meta-value {
                font-size: 13px;
            }

            .archive-sidebar {
                padding: 20px;
            }

            .archive-main {
                padding: 20px;
            }

            .archive-sidebar-title {
                font-size: 24px;
            }

            .notice-header {
                grid-template-columns: 40px 1fr;
                padding: 10px 12px;
                font-size: 12px;
            }

            .notice-header span:last-child {
                display: none;
            }

            .notice-item {
                grid-template-columns: 40px 1fr;
                padding: 12px;
            }

            .notice-item-num {
                font-size: 12px;
            }

            .notice-item-title {
                font-size: 13px;
            }

            .notice-item-date {
                display: none;
            }

            #resources-grid .notice-item-date {
                display: block;
                font-size: 11px;
            }

            #resources-grid .notice-header {
                grid-template-columns: 40px 1fr 70px;
            }

            #resources-grid .notice-item {
                grid-template-columns: 40px 1fr 70px;
            }

            .notice-pagination {
                padding: 15px;
                gap: 3px;
            }

            .notice-pagination button {
                min-width: 28px;
                height: 28px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- ===== Ìôà - 6Ïª¨Îüº Î¨¥ÏßÄÍ∞ú ===== -->
    <div id="home-page" class="page active">
        <div class="home-rainbow">
            <div class="home-col">
                <img src="logo.png" alt="ÌïúÍµ≠ ÌÄ¥Ïñ¥ Ïó∞Í∑π ÏïÑÏπ¥Ïù¥Î∏å" class="home-logo">
                <h1 class="home-col-title">ÌïúÍµ≠<br>ÌÄ¥Ïñ¥Ïó∞Í∑π<br>ÏïÑÏπ¥Ïù¥Î∏å</h1>
                <div class="home-col-content">
                    <p class="home-col-big" id="home-count">0</p>
                    <p class="home-col-small">Performances</p>
                </div>
            </div>

            <div class="home-col">
                <span class="home-col-label">Menu</span>
                <a href="#" onclick="goToPage('about'); return false;">ÏÜåÍ∞ú</a>
                <a href="#" onclick="goToPage('featured'); return false;">Í≥µÏßÄ</a>
                <a href="#" onclick="goToPage('archive'); return false;">ÏûëÌíàÎ™©Î°ù</a>
                <a href="#" onclick="goToPage('resources'); return false;">ÏûêÎ£å ‚Üó</a>
                <a href="https://docs.google.com/forms/d/e/1FAIpQLSfZO86fkhsnNi3vAnQp8jyZyjWQaIm9np3QWkkT8WnWxlTYOw/viewform" target="_blank">Ï†úÎ≥¥ ‚Üó</a>
                <a href="#" onclick="showRandomPerformance(); return false;">ÎûúÎç§</a>
            </div>

            <div class="home-col">
                <span class="home-col-label">Search</span>
                <input type="text" class="home-search-input" id="home-search" placeholder="ÏûëÌíàÎ™Ö, Í∑πÎã®..." onkeyup="handleHomeSearch(event)" style="margin-bottom: 15px;" />
                <p class="home-col-small" style="opacity: 0.6; margin-top: 0;">Enter ÌÇ§Î•º ÎàåÎü¨ Í≤ÄÏÉâ</p>
            </div>

            <div class="home-col">
                <span class="home-col-label">Tags</span>
                <div class="home-tag-list" id="home-tags"></div>
            </div>

            <div class="home-col">
                <span class="home-col-label">Archive</span>
                <p class="home-col-small">Korea Queer</p>
                <p class="home-col-small">Theater Archive</p>
            </div>

            <div class="home-col">
                <span class="home-col-label">Contact</span>
                <div class="home-col-content" style="margin-top: auto;">
                    <p class="home-col-small" style="margin-bottom: 12px; line-height: 1.6;">
                        Ïù¥Î©îÏùº<br>
                        <span style="opacity: 1;">queertheaterarchive@gmail.com</span>
                    </p>
                    <p class="home-col-small" style="margin-bottom: 12px; line-height: 1.6;">
                        X(Íµ¨: Ìä∏ÏúÑÌÑ∞)<br>
                        <a href="https://x.com/QueertheaterKr" target="_blank" style="color: inherit; opacity: 1; font-size: 11px;">@QueertheaterKr</a>
                    </p>
                    <p class="home-col-small" style="margin-top: 20px; font-size: 9px; opacity: 0.6;">
                        ¬© 2025 ÌïúÍµ≠ÌÄ¥Ïñ¥Ïó∞Í∑πÏïÑÏπ¥Ïù¥Î∏å
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== ÏïÑÏπ¥Ïù¥Î∏å ===== -->
    <div id="archive-page" class="page">
        <div class="archive-split">
            <div class="archive-sidebar">
                <a href="#" onclick="goToPage('home'); return false;" class="archive-back">‚Üê HOME</a>
                <h1 class="archive-sidebar-title">ÏûëÌíàÎ™©Î°ù</h1>
                <p class="archive-sidebar-count" id="archive-count">0Í∞úÏùò Í≥µÏó∞</p>
                <div class="archive-filters">
                    <select id="year-filter" class="archive-select" onchange="applyFilters()">
                        <option value="">Ïó∞ÎèÑ Ï†ÑÏ≤¥</option>
                    </select>
                    <select id="sort-filter" class="archive-select" onchange="applyFilters()">
                        <option value="random">ÎûúÎç§</option>
                        <option value="newest">ÏµúÏã†ÏûëÏàú</option>
                        <option value="oldest">Í≥ºÍ±∞ÏûëÏàú</option>
                        <option value="title">Í∞ÄÎÇòÎã§Ïàú</option>
                    </select>
                    <input type="text" id="archive-search" class="archive-input" placeholder="Í≤ÄÏÉâ..." oninput="applyFilters()" />
                    <button onclick="clearFilters()" class="archive-clear">Ï¥àÍ∏∞Ìôî</button>
                </div>
                <div id="selected-tags" class="archive-selected-tags"></div>
                <div id="cart-section" class="cart-section" style="display: none;">
                    <div class="cart-header">
                        <span class="cart-title">üìã ÏÑ†ÌÉù Î™©Î°ù (<span id="cart-count">0</span>)</span>
                        <button onclick="clearCart()" class="cart-clear-btn">ÎπÑÏö∞Í∏∞</button>
                    </div>
                    <div id="cart-list" class="cart-list"></div>
                    <button onclick="printCart()" class="cart-print-btn">üñ®Ô∏è Ïù∏ÏáÑÌïòÍ∏∞</button>
                </div>
                <div id="pagination" class="archive-pagination"></div>
            </div>
            <div class="archive-main">
                <div class="archive-list" id="archive-list"></div>
            </div>
        </div>
    </div>

    <!-- ===== ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄ ===== -->
    <div id="detail-page" class="page">
        <div id="detail-container"></div>
    </div>

    <!-- ===== ÏÜåÍ∞ú ÌéòÏù¥ÏßÄ ===== -->
    <div id="about-page" class="page">
        <div class="about-page-container">
            <header class="about-header">
                <a href="#" onclick="goToPage('home'); return false;" class="detail-back">‚Üê HOME</a>
                <span class="featured-title">ABOUT / ÏÜåÍ∞ú</span>
            </header>
            <div class="about-content-wrapper">
                <div class="about-logo-area">
                    <img src="logo.png" alt="ÌïúÍµ≠ ÌÄ¥Ïñ¥ Ïó∞Í∑π ÏïÑÏπ¥Ïù¥Î∏å" class="about-logo">
                </div>
                <div class="about-text-area" id="about-content">
                    <p>Î°úÎî© Ï§ë...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== Í≥µÏßÄ ÌéòÏù¥ÏßÄ ===== -->
    <div id="featured-page" class="page">
        <div class="featured-page">
            <header class="featured-header">
                <a href="#" onclick="goToPage('home'); return false;" class="detail-back">‚Üê HOME</a>
                <span class="featured-title">NOTICE / Í≥µÏßÄ</span>
            </header>
            <div class="featured-grid" id="featured-grid">
                <p style="padding: 40px; color: #fff;">Î°úÎî© Ï§ë...</p>
            </div>
        </div>
    </div>

    <!-- ===== ÏûêÎ£å ÌéòÏù¥ÏßÄ ===== -->
    <div id="resources-page" class="page">
        <div class="featured-page" style="background: #1a1a1a;">
            <header class="featured-header">
                <a href="#" onclick="goToPage('home'); return false;" class="detail-back">‚Üê HOME</a>
                <span class="featured-title">RESOURCES / ÏûêÎ£å</span>
            </header>
            <div class="featured-grid" id="resources-grid">
                <p style="padding: 40px; color: #fff;">Î°úÎî© Ï§ë...</p>
            </div>
        </div>
    </div>

    <!-- ===== Í∏Ä ÏÉÅÏÑ∏ ===== -->
    <div id="article-page" class="page">
        <div class="article-page">
            <header class="article-header">
                <a href="#" onclick="goToPage('featured'); return false;" class="detail-back">‚Üê FEATURED</a>
            </header>
            <div class="article-hero">
                <div class="article-hero-inner">
                    <h1 class="article-title" id="article-title"></h1>
                    <p class="article-meta" id="article-meta"></p>
                </div>
            </div>
            <div class="article-body">
                <div class="article-body-inner" id="article-body"></div>
            </div>
        </div>
    </div>

    <script>
        const WP_API_URL = 'https://queertheater.mycafe24.com/wp-json/wp/v2';
        
        let performances = [];
        let selectedTags = [];
        let allTags = [];
        let cart = [];

        async function fetchPerformances() {
            try {
                let allData = [];
                let page = 1;
                let hasMore = true;
                
                while (hasMore) {
                    const response = await fetch(`${WP_API_URL}/performance?per_page=100&page=${page}`);
                    const data = await response.json();
                    if (data.length > 0) { allData = allData.concat(data); page++; } 
                    else { hasMore = false; }
                    if (page > 10) hasMore = false;
                }
                
                performances = allData.map(item => {
                    const acf = item.acf || {};
                    let tags = [];
                    if (acf.tags) {
                        tags = acf.tags.includes('#') 
                            ? acf.tags.split('#').map(t => t.trim()).filter(t => t)
                            : acf.tags.split(',').map(t => t.trim()).filter(t => t);
                    }
                    let year = acf.date ? (acf.date.match(/\d{4}/) || ['2023'])[0] : '2023';
                    let posterUrl = acf.poster ? (typeof acf.poster === 'object' ? acf.poster.url : acf.poster) : null;
                    
                    let reviews = [];
                    if (acf.reviews) {
                        const lines = acf.reviews.split('\n').filter(l => l.trim());
                        reviews = lines.map(line => {
                            if (line.includes('|')) {
                                const [title, url] = line.split('|');
                                return { title: title.trim(), url: url ? url.trim() : '' };
                            }
                            const urlMatch = line.match(/(https?:\/\/[^\s\)]+)/);
                            if (urlMatch) {
                                const url = urlMatch[1];
                                const title = line.replace(url, '').replace(/[\(\)]/g, '').trim() || url;
                                return { title, url };
                            }
                            return { title: line.trim(), url: '' };
                        });
                    }
                    
                    let sortDate = 0;
                    if (acf.date) {
                        const dateMatch = acf.date.match(/(\d{4})\.(\d{2})\.(\d{2})/);
                        sortDate = dateMatch 
                            ? parseInt(dateMatch[1]) * 10000 + parseInt(dateMatch[2]) * 100 + parseInt(dateMatch[3])
                            : parseInt(year) * 10000;
                    }
                    
                    return {
                        id: item.id, title: item.title.rendered,
                        date: acf.date || '', venue: acf.venue || '', production: acf.production || '',
                        host: acf.Ï£ºÏµú || '', planning: acf.Í∏∞Ìöç || '', organizer: acf.Ï£ºÍ¥Ä || '',
                        author: acf.author || '', director: acf.director || '', actors: acf.actors || '',
                        staff: acf.staff || '', category: acf.category || '', description: acf.description || '',
                        source: acf.source || '', archiver_comment: acf.archiver_comment || '',
                        readings: acf.readings || '', similar: acf.similar || '',
                        tags, year: parseInt(year), sortDate, poster: posterUrl, reviews
                    };
                });

                allTags = [...new Set(performances.flatMap(p => p.tags))];
                
                const years = [...new Set(performances.map(p => p.year))].sort((a, b) => b - a);
                const yearFilter = document.getElementById('year-filter');
                if (yearFilter) {
                    years.forEach(y => {
                        const option = document.createElement('option');
                        option.value = y; option.textContent = y;
                        yearFilter.appendChild(option);
                    });
                }
                return performances;
            } catch (e) { console.error(e); return []; }
        }

        let pageHistory = ['home'];

        function goToPage(name, addToHistory = true) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(name + '-page').classList.add('active');
            if (name === 'archive') renderArchive();
            window.scrollTo(0, 0);
            if (addToHistory && pageHistory[pageHistory.length - 1] !== name) {
                pageHistory.push(name);
                history.pushState({ page: name }, '', `#${name}`);
            }
        }

        window.addEventListener('popstate', (e) => {
            if (e.state && e.state.page) {
                if (e.state.page === 'detail' && e.state.id) showDetail(e.state.id);
                else goToPage(e.state.page, false);
            } else {
                const hash = window.location.hash.replace('#', '');
                if (hash.startsWith('detail/')) {
                    const id = parseInt(hash.split('/')[1]);
                    if (id) showDetail(id);
                } else if (hash && document.getElementById(hash + '-page')) {
                    goToPage(hash, false);
                } else {
                    goToPage('home', false);
                }
            }
        });

        function formatText(text) {
            if (!text) return '';
            let result = text.replace(/&quot;/g, '"').replace(/&#039;/g, "'").replace(/&amp;/g, '&');
            result = result.replace(/"([^"]+)"/g, '\u201C$1\u201D').replace(/'([^']+)'/g, '\u2018$1\u2019');
            result = result.replace(/<(?![a-z\/])/g, '‚Äπ').replace(/(?<![a-z"])>/g, '‚Ä∫');
            result = result.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
            result = result.replace(/^[‚óè‚Ä¢]\s*(.+?)$/gm, '<strong>$1</strong>');
            result = result.replace(/Ï∂úÏ≤ò\|(https?:\/\/[^\s<‚Ä∫\n]+)/g, '<a href="$1" target="_blank">Ï∂úÏ≤ò</a>');
            result = result.replace(/Ï∂úÏ≤ò:(https?:\/\/[^\s<‚Ä∫\n]+)/g, '<a href="$1" target="_blank">Ï∂úÏ≤ò</a>');
            result = result.replace(/\(Ï∂úÏ≤ò:\s*(https?:\/\/[^\s\)]+)\)/g, '(<a href="$1" target="_blank">Ï∂úÏ≤ò</a>)');
            result = result.replace(/(?<!href=")(https?:\/\/[^\s<‚Ä∫\)]+)/g, '<a href="$1" target="_blank">$1</a>');
            const paragraphs = result.split(/\n\n+/);
            result = paragraphs.map(p => `<p>${p.replace(/\n/g, '<br>')}</p>`).join('');
            return result;
        }

        function initHomePage() {
            document.getElementById('home-count').textContent = performances.length;
            const tagsEl = document.getElementById('home-tags');
            if (tagsEl && allTags.length) {
                const shuffledTags = shuffleArray(allTags);
                tagsEl.innerHTML = shuffledTags.slice(0, 20).map(t => 
                    `<span class="home-tag-item" onclick="filterByTag('${t}')">${t}</span>`
                ).join('');
            }
            shuffledPerformances = shuffleArray(performances);
        }

        function showRandomPerformance() {
            if (performances.length) showDetail(performances[Math.floor(Math.random() * performances.length)].id);
        }

        function filterByTag(tag) {
            document.getElementById('archive-search').value = '';
            document.getElementById('year-filter').value = '';
            selectedTags = [tag];
            currentPage = 1;
            goToPage('archive');
            applyFilters();
        }

        function handleHomeSearch(e) {
            if (e.key === 'Enter') {
                e.target.blur();
                selectedTags = [];
                document.getElementById('archive-search').value = e.target.value;
                goToPage('archive');
            }
        }

        let currentPage = 1;
        const perPage = 25;
        let shuffledPerformances = [];

        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function renderArchive() {
            const search = document.getElementById('archive-search').value.toLowerCase();
            const year = document.getElementById('year-filter').value;
            const sort = document.getElementById('sort-filter').value;

            let filtered = performances.filter(p => {
                const searchTarget = [p.title, p.production, p.description, p.archiver_comment, p.venue, p.actors, p.staff, p.host, p.readings, p.tags.join(' ')].filter(Boolean).join(' ').toLowerCase();
                const matchSearch = !search || searchTarget.includes(search);
                const matchTags = !selectedTags.length || selectedTags.every(t => p.tags.includes(t));
                const matchYear = !year || p.year.toString() === year;
                return matchSearch && matchTags && matchYear;
            });

            if (sort === 'newest') filtered.sort((a, b) => b.sortDate - a.sortDate);
            else if (sort === 'oldest') filtered.sort((a, b) => a.sortDate - b.sortDate);
            else if (sort === 'title') filtered.sort((a, b) => a.title.localeCompare(b.title, 'ko'));
            else {
                if (shuffledPerformances.length !== performances.length) shuffledPerformances = shuffleArray(performances);
                filtered = shuffledPerformances.filter(p => filtered.some(f => f.id === p.id));
            }

            const totalPages = Math.ceil(filtered.length / perPage);
            if (currentPage > totalPages) currentPage = 1;
            const startIdx = (currentPage - 1) * perPage;
            const paginated = filtered.slice(startIdx, startIdx + perPage);

            document.getElementById('archive-count').textContent = `${filtered.length}Í∞úÏùò Í≥µÏó∞`;
            document.getElementById('selected-tags').innerHTML = selectedTags.map(t => 
                `<span class="archive-selected-tag" onclick="removeTag('${t}')">#${t} ‚úï</span>`
            ).join('');

            document.getElementById('archive-list').innerHTML = paginated.map((p, i) => `
                <div class="archive-item">
                    <input type="checkbox" class="archive-item-checkbox" ${cart.some(c => c.id === p.id) ? 'checked' : ''} onclick="event.stopPropagation(); toggleCart(${p.id})" />
                    <span class="archive-item-index">${String(startIdx + i + 1).padStart(3, '0')}</span>
                    <div class="archive-item-info" onclick="showDetail(${p.id})">
                        <div class="archive-item-title">${p.title}</div>
                        <div class="archive-item-meta">${p.production && p.venue ? p.production + ' ¬∑ ' + p.venue : (p.venue || p.production || '')}</div>
                    </div>
                    <span class="archive-item-year">${p.year}</span>
                </div>
            `).join('');

            const paginationEl = document.getElementById('pagination');
            if (totalPages > 1) {
                let html = '';
                if (currentPage > 1) html += `<button onclick="goPage(${currentPage - 1})">‚Üê</button>`;
                for (let i = 1; i <= totalPages; i++) html += i === currentPage ? `<button class="active">${i}</button>` : `<button onclick="goPage(${i})">${i}</button>`;
                if (currentPage < totalPages) html += `<button onclick="goPage(${currentPage + 1})">‚Üí</button>`;
                paginationEl.innerHTML = html;
            } else paginationEl.innerHTML = '';
        }

        function goPage(page) { currentPage = page; renderArchive(); document.querySelector('.archive-main').scrollTo(0, 0); }
        function applyFilters() { currentPage = 1; renderArchive(); }
        function clearFilters() {
            document.getElementById('archive-search').value = '';
            document.getElementById('year-filter').value = '';
            document.getElementById('sort-filter').value = 'random';
            selectedTags = []; currentPage = 1;
            shuffledPerformances = shuffleArray(performances);
            renderArchive();
        }
        function removeTag(tag) { selectedTags = selectedTags.filter(t => t !== tag); renderArchive(); }

        function toggleCart(id) {
            const p = performances.find(x => x.id === id);
            if (!p) return;
            const idx = cart.findIndex(c => c.id === id);
            if (idx > -1) cart.splice(idx, 1);
            else cart.push({ id: p.id, title: p.title, year: p.year, production: p.production, venue: p.venue, date: p.date });
            updateCartUI();
        }

        function updateCartUI() {
            const section = document.getElementById('cart-section');
            if (cart.length === 0) { section.style.display = 'none'; return; }
            section.style.display = 'block';
            document.getElementById('cart-count').textContent = cart.length;
            document.getElementById('cart-list').innerHTML = cart.map(item => `
                <div class="cart-item">
                    <span class="cart-item-title">${item.title} (${item.year})</span>
                    <button class="cart-item-remove" onclick="removeFromCart(${item.id})">‚úï</button>
                </div>
            `).join('');
        }

        function removeFromCart(id) { cart = cart.filter(c => c.id !== id); updateCartUI(); renderArchive(); }
        function clearCart() { cart = []; updateCartUI(); renderArchive(); }

        function printCart() {
            if (cart.length === 0) { alert('ÏÑ†ÌÉùÎêú Í≥µÏó∞Ïù¥ ÏóÜÏäµÎãàÎã§.'); return; }
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>ÌïúÍµ≠ ÌÄ¥Ïñ¥ Ïó∞Í∑π ÏïÑÏπ¥Ïù¥Î∏å - ÏÑ†ÌÉù Î™©Î°ù</title><style>body{font-family:"Noto Sans KR",sans-serif;padding:40px}h1{font-size:24px;margin-bottom:10px}.subtitle{color:#666;margin-bottom:30px}table{width:100%;border-collapse:collapse}th,td{padding:12px;text-align:left;border-bottom:1px solid #ddd}th{background:#f5f5f5;font-weight:600}.footer{margin-top:40px;font-size:12px;color:#999}</style></head><body><h1>ÌïúÍµ≠ ÌÄ¥Ïñ¥ Ïó∞Í∑π ÏïÑÏπ¥Ïù¥Î∏å</h1><p class="subtitle">ÏÑ†ÌÉùÌïú Í≥µÏó∞ Î™©Î°ù (${cart.length}Í∞ú)</p><table><thead><tr><th>Î≤àÌò∏</th><th>ÏûëÌíàÎ™Ö</th><th>Ïó∞ÎèÑ</th><th>Ï†úÏûë</th><th>Ïû•ÏÜå</th></tr></thead><tbody>${cart.map((item, i) => `<tr><td>${i + 1}</td><td>${item.title}</td><td>${item.year}</td><td>${item.production || '-'}</td><td>${item.venue || '-'}</td></tr>`).join('')}</tbody></table><p class="footer">Ï∂úÎ†•Ïùº: ${new Date().toLocaleDateString('ko-KR')} | https://pipicocucumong.github.io/queer-theater-archive/</p></body></html>`);
            printWindow.document.close();
            printWindow.print();
        }

        function showDetail(id) {
            const p = performances.find(x => x.id === id);
            if (!p) return;

            const tagsHtml = (p.tags || []).map(tag => `<span class="detail-tag" onclick="filterByTag('${tag}')">#${tag}</span>`).join('');
            let readingsContent = '';
            if (p.readings) readingsContent += formatText(p.readings);
            if (p.reviews && p.reviews.length) {
                readingsContent += `<ul class="detail-links">${p.reviews.map(r => r.url ? `<li><a href="${r.url}" target="_blank">${r.title}</a></li>` : `<li style="opacity:0.8;">${r.title}</li>`).join('')}</ul>`;
            }

            document.getElementById('detail-container').innerHTML = `
                <div class="detail-page">
                    <div class="detail-left">
                        <div class="detail-left-inner">
                            <a href="#archive" class="detail-back" onclick="goToPage('archive'); return false;">‚Üê ÏûëÌíàÎ™©Î°ù</a>
                            <div class="detail-poster">
                                ${p.poster ? `<img src="${p.poster}" alt="${p.title}" onerror="this.parentElement.innerHTML='<div class=\\'detail-poster-empty\\'>NO POSTER</div>'">` : '<div class="detail-poster-empty">NO POSTER</div>'}
                            </div>
                            <h1 class="detail-title">${p.title}</h1>
                            <div class="detail-meta-grid">
                                ${p.date ? `<div class="detail-meta-item"><div class="detail-meta-label">ÏùºÏãú</div><div class="detail-meta-value">${p.date}</div></div>` : ''}
                                ${p.venue ? `<div class="detail-meta-item"><div class="detail-meta-label">Ïû•ÏÜå</div><div class="detail-meta-value">${p.venue}</div></div>` : ''}
                                ${p.production ? `<div class="detail-meta-item"><div class="detail-meta-label">Ï†úÏûë</div><div class="detail-meta-value">${p.production}</div></div>` : ''}
                                ${p.host ? `<div class="detail-meta-item"><div class="detail-meta-label">Ï£ºÏµú</div><div class="detail-meta-value">${p.host}</div></div>` : ''}
                                ${p.planning ? `<div class="detail-meta-item"><div class="detail-meta-label">Í∏∞Ìöç</div><div class="detail-meta-value">${p.planning}</div></div>` : ''}
                                ${p.organizer ? `<div class="detail-meta-item"><div class="detail-meta-label">Ï£ºÍ¥Ä</div><div class="detail-meta-value">${p.organizer}</div></div>` : ''}
                                ${p.director ? `<div class="detail-meta-item"><div class="detail-meta-label">Ï∞∏Í≥†</div><div class="detail-meta-value">${p.director}</div></div>` : ''}
                                ${p.actors ? `<div class="detail-meta-item"><div class="detail-meta-label">Î∞∞Ïö∞</div><div class="detail-meta-value">${p.actors}</div></div>` : ''}
                                ${p.staff ? `<div class="detail-meta-item"><div class="detail-meta-label">Ïä§ÌÉúÌîÑ</div><div class="detail-meta-value">${p.staff}</div></div>` : ''}
                            </div>
                            <div class="detail-tags">${tagsHtml}</div>
<div class="share-section">
    <div class="share-label">Í≥µÏú†ÌïòÍ∏∞</div>
    <div class="share-buttons">
        <button class="share-btn" onclick="copyLink(${p.id}, '${p.title.replace(/'/g, "\\'")}')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
            ÎßÅÌÅ¨ Î≥µÏÇ¨
        </button>
        <button class="share-btn" onclick="shareTwitter(${p.id}, '${p.title.replace(/'/g, "\\'")}')">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            X
        </button>
        <button class="share-btn" onclick="shareNative(${p.id}, '${p.title.replace(/'/g, "\\'")}')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
            ÎçîÎ≥¥Í∏∞
        </button>
    </div>
</div>
                        </div>
                    </div>
                    <div class="detail-right">
                        <div class="detail-right-top">
                            <div class="detail-section">
                                <h2 class="detail-section-title">Í≥µÏãù ÏÜåÍ∞ú</h2>
                                ${p.description ? `<div class="detail-text">${formatText(p.description)}</div>${p.source ? `<div class="detail-source"><a href="${p.source}" target="_blank">Ï∂úÏ≤ò</a></div>` : ''}` : '<p class="detail-empty">Îì±Î°ùÎêú ÏÜåÍ∞úÍ∞Ä ÏóÜÏäµÎãàÎã§.</p>'}
                            </div>
                            ${p.archiver_comment ? `<div class="detail-archiver-section"><h3 class="detail-section-subtitle">ÏïÑÏπ¥Ïù¥Î≤Ñ Ìïú ÎßàÎîî</h3><div class="detail-text">${formatText(p.archiver_comment)}</div></div>` : ''}
                        </div>
                        <div class="detail-right-bottom">
                            <div class="detail-section">
                                <h2 class="detail-section-title">ÏùΩÏùÑÍ±∞Î¶¨</h2>
                                ${readingsContent ? `<div class="detail-text">${readingsContent}</div>` : '<p class="detail-empty">Îì±Î°ùÎêú ÏùΩÏùÑÍ±∞Î¶¨Í∞Ä ÏóÜÏäµÎãàÎã§.</p>'}
                            </div>
                            ${p.similar ? `<div class="detail-section" style="margin-top: 30px; padding-top: 25px; border-top: 1px solid rgba(255,255,255,0.2);"><h3 class="detail-section-subtitle">ÎπÑÏä∑Ìïú Í≥µÏó∞</h3><div class="detail-text">${formatText(p.similar)}</div></div>` : ''}
                        </div>
                    </div>
                </div>
            `;
            goToPage('detail');
            history.replaceState({ page: 'detail', id: id }, '', `#detail/${id}`);
        }

// ========== Í≥µÏú† Í∏∞Îä• ==========
function getShareUrl(id) {
    return `https://queertheater.kr/#detail/${id}`;
}

function showToast(message) {
    const existing = document.querySelector('.share-toast');
    if (existing) existing.remove();
    
    const toast = document.createElement('div');
    toast.className = 'share-toast';
    toast.textContent = message;
    document.body.appendChild(toast);
    
    setTimeout(() => toast.remove(), 2500);
}

function copyLink(id, title) {
    const url = getShareUrl(id);
    
    if (navigator.clipboard) {
        navigator.clipboard.writeText(url).then(() => {
            showToast('üîó ÎßÅÌÅ¨Í∞Ä Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!');
        }).catch(() => {
            fallbackCopy(url);
        });
    } else {
        fallbackCopy(url);
    }
}

function fallbackCopy(text) {
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.select();
    try {
        document.execCommand('copy');
        showToast('üîó ÎßÅÌÅ¨Í∞Ä Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!');
    } catch (e) {
        showToast('ÎßÅÌÅ¨ Î≥µÏÇ¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
    }
    document.body.removeChild(textarea);
}

function shareTwitter(id, title) {
    const url = getShareUrl(id);
    const text = `${title} - ÌïúÍµ≠ ÌÄ¥Ïñ¥ Ïó∞Í∑π ÏïÑÏπ¥Ïù¥Î∏å`;
    const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;
    window.open(twitterUrl, '_blank', 'width=550,height=420');
}

function shareNative(id, title) {
    const url = getShareUrl(id);
    const shareData = {
        title: title,
        text: `${title} - ÌïúÍµ≠ ÌÄ¥Ïñ¥ Ïó∞Í∑π ÏïÑÏπ¥Ïù¥Î∏å`,
        url: url
    };

    if (navigator.share) {
        navigator.share(shareData).catch(() => {});
    } else {
        copyLink(id, title);
    }
}



        // ========== Í≥µÏßÄ(Featured) ==========
        let noticeArticles = [];
        let noticeCurrentPage = 1;
        const noticePerPage = 10;

        async function loadNotices() {
            try {
                const catRes = await fetch(`${WP_API_URL}/categories?slug=notice&_=${Date.now()}`);
                const categories = await catRes.json();
                if (categories.length === 0) { document.getElementById('featured-grid').innerHTML = '<div class="notice-empty">Í≥µÏßÄ Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä ÏóÜÏäµÎãàÎã§.</div>'; return; }
                
                const res = await fetch(`${WP_API_URL}/posts?categories=${categories[0].id}&per_page=100&_=${Date.now()}`);
                const posts = await res.json();
                if (posts.length === 0) { document.getElementById('featured-grid').innerHTML = '<div class="notice-empty">Îì±Î°ùÎêú Í≥µÏßÄÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>'; return; }
                
                noticeArticles = posts.map(post => ({
                    id: post.id, title: post.title.rendered,
                    excerpt: post.excerpt.rendered.replace(/<[^>]*>/g, '').trim().slice(0, 80) + '...',
                    content: post.content.rendered,
                    date: new Date(post.date).toLocaleDateString('ko-KR', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\. /g, '.').replace('.', '')
                }));
                renderFeaturedGrid();
            } catch (e) { console.error('Í≥µÏßÄ Î°úÎìú Ïã§Ìå®:', e); document.getElementById('featured-grid').innerHTML = '<div class="notice-empty">Í≥µÏßÄÎ•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.</div>'; }
        }

        function renderFeaturedGrid() {
            const grid = document.getElementById('featured-grid');
            if (noticeArticles.length === 0) { grid.innerHTML = '<div class="notice-empty">Îì±Î°ùÎêú Í≥µÏßÄÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>'; return; }

            const totalPages = Math.ceil(noticeArticles.length / noticePerPage);
            if (noticeCurrentPage > totalPages) noticeCurrentPage = 1;
            const startIdx = (noticeCurrentPage - 1) * noticePerPage;
            const paginated = noticeArticles.slice(startIdx, startIdx + noticePerPage);
            const totalCount = noticeArticles.length;

            let paginationHTML = '';
            if (totalPages > 1) {
                if (noticeCurrentPage > 1) paginationHTML += `<button onclick="goNoticePage(${noticeCurrentPage - 1})">‚Äπ</button>`;
                for (let i = 1; i <= totalPages; i++) paginationHTML += `<button class="${i === noticeCurrentPage ? 'active' : ''}" onclick="goNoticePage(${i})">${i}</button>`;
                if (noticeCurrentPage < totalPages) paginationHTML += `<button onclick="goNoticePage(${noticeCurrentPage + 1})">‚Ä∫</button>`;
            }

            grid.innerHTML = `<div class="notice-board"><div class="notice-header"><span>Î≤àÌò∏</span><span>Ï†úÎ™©</span><span>ÎÇ†Ïßú</span></div><div class="notice-list">${paginated.map((article, index) => `<div class="notice-item" onclick="showNoticeArticle(${article.id})"><span class="notice-item-num">${totalCount - startIdx - index}</span><span class="notice-item-title">${article.title}</span><span class="notice-item-date">${article.date}</span></div>`).join('')}</div>${totalPages > 1 ? `<div class="notice-pagination">${paginationHTML}</div>` : ''}</div>`;
        }

        function goNoticePage(page) { noticeCurrentPage = page; renderFeaturedGrid(); document.getElementById('featured-grid').scrollIntoView({ behavior: 'smooth' }); }

        // ========== ÏûêÎ£å(Resources) ==========
        let resourceArticles = [];
        let resourceCurrentPage = 1;
        const resourcePerPage = 10;

        async function loadResources() {
            try {
                const catRes = await fetch(`${WP_API_URL}/categories?slug=resources&_=${Date.now()}`);
                const categories = await catRes.json();
                if (categories.length === 0) { document.getElementById('resources-grid').innerHTML = '<div class="notice-empty">ÏûêÎ£å Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä ÏóÜÏäµÎãàÎã§.</div>'; return; }
                
                const res = await fetch(`${WP_API_URL}/posts?categories=${categories[0].id}&per_page=100&_=${Date.now()}`);
                const posts = await res.json();
                if (posts.length === 0) { document.getElementById('resources-grid').innerHTML = '<div class="notice-empty">Îì±Î°ùÎêú ÏûêÎ£åÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>'; return; }
                
                resourceArticles = posts.map(post => {
                    const acf = post.acf || {};
                    let fileUrl = acf.file_url || acf.file || '';
                    if (!fileUrl) {
                        const match = post.content.rendered.match(/href="([^"]+\.pdf)"/i);
                        if (match) fileUrl = match[1];
                    }
                    return {
                        id: post.id, title: post.title.rendered, content: post.content.rendered, fileUrl: fileUrl,
                        date: new Date(post.date).toLocaleDateString('ko-KR', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\. /g, '.').replace('.', '')
                    };
                });
                renderResourcesGrid();
            } catch (e) { console.error('ÏûêÎ£å Î°úÎìú Ïã§Ìå®:', e); document.getElementById('resources-grid').innerHTML = '<div class="notice-empty">ÏûêÎ£åÎ•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.</div>'; }
        }

        function renderResourcesGrid() {
            const grid = document.getElementById('resources-grid');
            if (resourceArticles.length === 0) { grid.innerHTML = '<div class="notice-empty">Îì±Î°ùÎêú ÏûêÎ£åÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>'; return; }

            const totalPages = Math.ceil(resourceArticles.length / resourcePerPage);
            if (resourceCurrentPage > totalPages) resourceCurrentPage = 1;
            const startIdx = (resourceCurrentPage - 1) * resourcePerPage;
            const paginated = resourceArticles.slice(startIdx, startIdx + resourcePerPage);
            const totalCount = resourceArticles.length;

            let paginationHTML = '';
            if (totalPages > 1) {
                if (resourceCurrentPage > 1) paginationHTML += `<button onclick="goResourcePage(${resourceCurrentPage - 1})">‚Äπ</button>`;
                for (let i = 1; i <= totalPages; i++) paginationHTML += `<button class="${i === resourceCurrentPage ? 'active' : ''}" onclick="goResourcePage(${i})">${i}</button>`;
                if (resourceCurrentPage < totalPages) paginationHTML += `<button onclick="goResourcePage(${resourceCurrentPage + 1})">‚Ä∫</button>`;
            }

            grid.innerHTML = `<div class="notice-board"><div class="notice-header"><span>Î≤àÌò∏</span><span>Ï†úÎ™©</span><span>Îã§Ïö¥Î°úÎìú</span></div><div class="notice-list">${paginated.map((article, index) => `<div class="notice-item"><span class="notice-item-num">${totalCount - startIdx - index}</span><span class="notice-item-title">${article.title}</span><span class="notice-item-date">${article.fileUrl ? `<a href="${article.fileUrl}" target="_blank" style="color:#24408E;">üì• Îã§Ïö¥Î°úÎìú</a>` : '-'}</span></div>`).join('')}</div>${totalPages > 1 ? `<div class="notice-pagination">${paginationHTML}</div>` : ''}</div>`;
        }

        function goResourcePage(page) { resourceCurrentPage = page; renderResourcesGrid(); document.getElementById('resources-grid').scrollIntoView({ behavior: 'smooth' }); }

        function showNoticeArticle(id) {
            const article = noticeArticles.find(a => a.id === id);
            if (!article) return;
            document.getElementById('article-title').textContent = article.title;
            document.getElementById('article-meta').textContent = article.date;
            document.getElementById('article-body').innerHTML = article.content;
            goToPage('article');
        }

        // ========== ÏÜåÍ∞ú ÌéòÏù¥ÏßÄ Î°úÎìú ==========
        async function loadAboutPage() {
            try {
                const res = await fetch(`${WP_API_URL}/pages/81?_=${Date.now()}`);
                const page = await res.json();
                if (page && page.content) {
                    let content = page.content.rendered;
                    content = convertToTimeline(content);
                    document.getElementById('about-content').innerHTML = content;
                } else {
                    document.getElementById('about-content').innerHTML = '<p>ÏÜåÍ∞ú ÌéòÏù¥ÏßÄÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.</p>';
                }
            } catch (e) {
                console.error('ÏÜåÍ∞ú ÌéòÏù¥ÏßÄ Î°úÎìú Ïã§Ìå®:', e);
                document.getElementById('about-content').innerHTML = '<p>ÏÜåÍ∞ú ÌéòÏù¥ÏßÄÎ•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.</p>';
            }
        }

        // Ïó∞ÌòÅ ÏÑπÏÖòÏùÑ ÌÉÄÏûÑÎùºÏù∏ ÌòïÏãùÏúºÎ°ú Î≥ÄÌôò
        function convertToTimeline(html) {
            const temp = document.createElement('div');
            temp.innerHTML = html;
            
            const paragraphs = Array.from(temp.querySelectorAll('p'));
            
            // "Ïó∞ÌòÅ"Ïù¥ Ìè¨Ìï®Îêú ÏöîÏÜå Ï∞æÍ∏∞
            let timelineStartIndex = -1;
            for (let i = 0; i < paragraphs.length; i++) {
                const text = paragraphs[i].textContent.trim();
                if (text === 'Ïó∞ÌòÅ' || paragraphs[i].innerHTML.includes('<strong>Ïó∞ÌòÅ</strong>')) {
                    timelineStartIndex = i;
                    break;
                }
            }
            
            if (timelineStartIndex === -1) return html;
            
            const timelineItems = [];
            const elementsToRemove = [];
            
            for (let i = timelineStartIndex + 1; i < paragraphs.length; i++) {
                const p = paragraphs[i];
                const text = p.textContent.trim();
                
                if (!text) { elementsToRemove.push(p); continue; }
                
                // Îã§Ïùå ÏÑπÏÖò Ï†úÎ™©Ïù¥ ÎÇòÏò§Î©¥ Ï§ëÎã®
                if (p.innerHTML.match(/^<strong>[^<]+<\/strong>$/) && !text.match(/^\d{4}/)) break;
                
                // ÎÇ†Ïßú Ìå®ÌÑ¥ Ï∞æÍ∏∞ (YYYY. M ÎòêÎäî YYYY. MM ÌòïÏãù)
                const dateMatch = text.match(/^(\d{4}\.\s*\d{1,2})\s*/);
                if (dateMatch) {
                    const date = dateMatch[1].trim();
                    const content = text.replace(dateMatch[0], '').trim();
                    if (content) timelineItems.push({ date, content });
                    elementsToRemove.push(p);
                }
            }
            
            if (timelineItems.length > 0) {
                let timelineHtml = '<h2 style="color: #7B2D8E; margin-top: 30px; margin-bottom: 15px;">Ïó∞ÌòÅ</h2><div class="timeline">';
                timelineItems.forEach(item => {
                    timelineHtml += `<div class="timeline-item"><div class="timeline-date">${item.date}</div><div class="timeline-content">${item.content}</div></div>`;
                });
                timelineHtml += '</div>';
                
                paragraphs[timelineStartIndex].outerHTML = timelineHtml;
                elementsToRemove.forEach(el => { if (el.parentNode) el.remove(); });
            }
            
            return temp.innerHTML;
        }

        // Ï¥àÍ∏∞Ìôî
        fetchPerformances().then(() => {
            initHomePage();
            loadAboutPage();
            loadNotices();
            loadResources();
            
            const hash = window.location.hash.replace('#', '');
            if (hash) {
                if (hash.startsWith('detail/')) {
                    const id = parseInt(hash.split('/')[1]);
                    if (id && performances.find(p => p.id === id)) showDetail(id);
                    else goToPage('archive', false);
                } else if (hash === 'detail') {
                    goToPage('archive', false);
                } else if (document.getElementById(hash + '-page')) {
                    goToPage(hash, false);
                }
            }
        });
    </script>
</body>
</html>
